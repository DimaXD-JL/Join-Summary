<div
  class="shaddowBox"
  [class.closing]="isClosing"
  (click)="closeOverlay.emit()"
>
  <div class="task_card_wrapper" (click)="$event.stopPropagation()">
    <div class="task-container">
      <div class="header-task">
        <div
          class="task-category"
          [ngStyle]="{ 'background-color': getCategoryColor(todo?.category) }"
        >
          @if (!isEditing) {
          <span>{{ todo?.category }}</span>
          } @else {
          <input [(ngModel)]="editedTodo.category" />
          }
        </div>
        <div class="close" (click)="closeOverlay.emit()">
          <img src="/assets/icons/close.png" alt="close" />
        </div>
      </div>

      @if (!isEditing) {
      <span>{{ todo?.title }}</span>
      } @else {
      <input [(ngModel)]="editedTodo.title" />
      } @if (!isEditing) {
      <span>{{ todo?.description }}</span>
      } @else {
      <input [(ngModel)]="editedTodo.description" />
      }

      <div class="priority-date">
        <span>Due date:</span>
        @if (!isEditing) {
        <span>{{ todo?.dueDate }}</span>
        } @else {
        <input type="date" [(ngModel)]="editedTodo.dueDate" />
        }
      </div>

      <div class="priority">
        <span>Priority:</span>
        <div class="priority-icon">
          @if (!isEditing) {
          <span>{{ todo?.priority }}</span>
          } @else {
          <select [(ngModel)]="editedTodo.priority">
            <option value="urgent">rgent</option>
            <option value="medium">Medium</option>
            <option value="low">Low</option>
          </select>
          }
          <img
            [src]="getPriorityIcon(todo?.priority)"
            alt="{{ todo?.priority }}"
          />
        </div>
      </div>

      <span>Assigned TO :</span>
      <div class="assigned-container">
        @for (contact of selectedContacts; track contact) {
        <div
          class="circle-of-task"
          [ngStyle]="{ 'background-color': getAvatarColor(contact) }"
        >
          {{ getInitials(contact.name) }}
        </div>
        } @if (!isEditing) {
        <span>{{ todo?.assignedTo }}</span>
        } @else {
        <input [(ngModel)]="editedTodo.assignedTo" />
        }
      </div>

      <div class="subtasks">
        <span>Subtasks</span>
        <div class="subtask-container">
          <img
            [src]="isChecked ? checkedImage : uncheckedImage"
            alt="check_box"
            (click)="toggleCheckBox()"
          />
          @if (!isEditing) {
          <span>{{ todo?.subtasks }}</span>
          } @else {
          <input [(ngModel)]="editedTodo.subtasks" />
          }
        </div>
      </div>

      <div class="delete-edit-container">
        <div class="deleteIcon" *ngIf="!isEditing">
          <img
            class="delete-icon"
            src="/assets/icons/delete.png"
            alt="delete-icon"
          />
          <span class="contact-link" (click)="deleteTodo()">Delete</span>
        </div>
        <hr *ngIf="!isEditing" />
        <div class="editIcon">
          @if (!isEditing) {
          <img
            class="edit-icon"
            src="/assets/icons/edit.png"
            alt="edit-icon"
            (click)="editTodo()"
          />
          <span class="contact-link" (click)="editTodo()">Edit</span>
          } @else {
          <div>
            <button class="check-task-btn" (click)="saveTodo()">
              Ok
              <img src="/assets/icons/check.png" alt="check-contact-button" />
            </button>
          </div>
          }
        </div>
      </div>
    </div>
  </div>
</div>
